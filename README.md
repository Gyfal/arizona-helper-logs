# Arizona Helper Extension

Расширение для Chrome/Chromium, упрощающее работу с логами Arizona RP и инструментами Shinoa. Автоматизирует разбиение периодов, показывает цены и помогает анализировать взаимодействия игроков.

## Возможности
- Авторазбиение больших периодов на arizonarp.logsparser.info (чтобы обходить 504 и пустые ответы), шаг периода настраивается.
- Отрисовка цен предметов прямо в логах (основной ассортимент + кастомные цены).
- Экспорт любой выборки логов в CSV одной кнопкой.
- Линейка анализа игроков: просмотр действий до/после события в заданном окне времени и поиск пересечений двух игроков за 9 месяцев.
- Подсветка подозрительных обменов (багажник, дом, склад, почта) с настройкой порогов.
- Интеграция с Shinoa: геолокация IP, данные привязок (VK/Telegram/Email), история IP за все время, отображение цен с https://items.shinoa.tech/.

## Установка
1. Откройте `chrome://extensions` и включите «Режим разработчика».
2. Нажмите «Загрузить распакованное» и выберите папку `arizona-helper-extension`.
3. Убедитесь, что у расширения есть доступ к `arizonarp.logsparser.info`, `logs.shinoa.tech` и `items.shinoa.tech`.

## Как использовать
- **Авторазбиение**: задайте период в фильтрах логов — расширение само разобьет запрос на части и прогонит их по очереди. Максимальный размер периода регулируется в настройках.
- **CSV-выгрузка**: на странице логов появится кнопка «Скачать CSV» — выгружает текущую выборку в файл.
- **Цены в логах**: напротив предметов выводится актуальная цена. При необходимости можно переопределять цены и сохранять `custom_prices.json` через попап.
- **Аналитика игроков**:
  - В фильтрах можно «пригвоздить» событие и посмотреть, что игрок делал за час до и два часа после, не покидая страницы (например, для цепочек сделок вроде: `https://arizonarp.logsparser.info/?type[]=exchange_property&type[]=sellbizto&type[]=sellcarto&type[]=sellhouseto&sort=desc&min_period=2025-04-29+00:00:00`).
  - Поиск общих действий двух игроков за последние 9 месяцев для выявления возможных договоренностей.
- **Shinoa**: на страницах `/tech/player/*` показывается гео по IP (batch-запросы на ip-api), история IP, привязки и цены с items.shinoa.tech; работает поверх таблиц без открытия новых вкладок.

## Настройки (значок расширения)
- Максимальный размер периода (в месяцах) для авторазбиения.
- Переключатели: авторазбиение, кнопка CSV.
- Пороги подозрительных событий: сумма и окно по багажнику/дому/складу, минимальное число аккаунтов на одну почту.
- Управление ценами: экспорт `custom_prices.json`, сброс всех переопределений.

## Данные и права
Расширение использует `storage` для настроек и переопределенных цен, `downloads` для экспорта CSV и `custom_prices.json`, а также выполняет запросы к ip-api.com только по вашим IP-адресам из логов.
